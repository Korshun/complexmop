ACTOR PossessedPhaseImp : PossessedDevilImp
{
	Player.MorphWeapon "PhaseImpWeapon"
	
    Health 100
    Speed 0.4
    PainChance 80
	+QUICKTORETALIATE
	BloodColor "cf 00 b0"
	DropItem "LifeEssence" 125
	DropItem "ArmorBonusMax" 125
	DropItem "DemonAmmo" 128 60
    SeeSound "phaseimp/sight"
    PainSound "phaseimp/pain"
    DeathSound "phaseimp/death"
    ActiveSound "phaseimp/active"
    Obituary "%o was pierced by a Phase Imp."
    HitObituary "%o was lacerated by a Phase Imp."
    States
    {
    Spawn:
        DIMP A 10
		DIMI A 10
        Loop
    See:
		TNT1 A 0 A_Jump(38,"Evade")
		DIMP AABB 3 A_Chase
		TNT1 A 0 A_SpawnItem("HumanishStep",0,0,0,0)
		DIMP CCDD 3 A_Chase
		TNT1 A 0 A_SpawnItem("HumanishStep",0,0,0,0)
		TNT1 A 0 A_Jump(46,"Phase")		
        Loop
    Missile:
        DIMP EF 6
		TNT1 A 0 Bright
        DIMP G 5 Bright
		DIMP FE 4
		DIMP E 10
        Goto See
	Evade:
		TNT1 A 0 A_Jump(128,7)
		TNT1 A 0 ThrustThing(Angle*256/360+64,16,0,0)
		DIMP AAAA 3 A_Chase
		TNT1 A 0 A_Stop
		Goto See
		TNT1 A 0 ThrustThing(Angle*256/360+192,16,0,0)
		DIMP AAAA 3 A_Chase
		TNT1 A 0 A_Stop
		Goto See
	Phased:
        DIMP AABBCCDDAABBCCDDAABBCCDDAABBCCDD 1 A_ExtChase(0,0)
        DIMP AABBCCDDAABBCCDD 1 A_Chase
		TNT1 A 0 A_Jump(24,"UnPhase")
        Goto Phased+32
	}
}

Actor PhaseImpWeapon : PossessedWeapon
{
	States
	{
	Select:
		POSS A 35
		TNT1 A 0 ACS_ExecuteWithResult(mop_phaseimp, 0)
		Goto Super::Select
	Fire:
		DIMP EF 6
		TNT1 A 0 Bright A_PlaySound("imp/attack")
        DIMP G 5 Bright A_FireCustomMissile("PhaseImpBall")
		DIMP FE 4
		Goto Ready
	}
}

Actor ImpPhaseItem : CustomInventory
{
	States
	{
	Pickup:
		TNT1 A 1 A_SetTranslucent(0.75)
		TNT1 A 1 A_SetTranslucent(0.5)
		TNT1 A 1 A_SetTranslucent(0.25)
		TNT1 A 1 A_SetTranslucent(0)
		Stop
	}
}

Actor ImpUnphaseItem : CustomInventory
{
	States
	{
	Pickup:
		TNT1 A 1 A_SetTranslucent(0.25)
		TNT1 A 1 A_SetTranslucent(0.5)
		TNT1 A 1 A_SetTranslucent(0.75)
		TNT1 A 1 A_SetTranslucent(1)
		Stop
	}
}
